---
slug: /deploiement/deploiement-site
sidebar_position: 1
title : D√©ployer le site
---

**Mise √† jour: 20 f√©vrier 2024**

## Introduction

Dans ce tutoriel, vous retrouverez toutes les √©tapes pour d√©ployer le site internet 
Michaud et Fils qui permettera aux clients un acc√®s au site internet.

## Pr√©requis

Pour d√©ployer le site il faut:

- Un compte [Azure](https://azure.microsoft.com/en-ca/get-started/azure-portal)
- Obtenir un [courriel](https://accounts.google.com/) valide.
- [PostgreSQL](https://www.postgresql.org/)(celui du site internet de Michaud et fils).
- [DataGrip](https://www.jetbrains.com/datagrip/)



<details open> 
<summary>test</summary>

This is how you dropdown.
</details> 


Prenez note que la cr√©ation de compte ne sera pas expliqu√©e dans ce tutoriel. Le tutoriel
commence sur le site d'[Azure de microsoft](https://azure.microsoft.com/fr-ca/)
Et que vous √™tes connect√©s avec votre compte. Le d√©but commencera √† la page principale.

## Proc√©dure

1. Lorsque vous √™tes connect√©s sur votre compte, aller dans la barre de recherche en haut et tapez
    "Serveur Azure Database pour PostgreSQL".

2. Ensuite, cliquez sur "Cr√©er Serveur Azure Database pour PostgreSQL".

3. Onglet __de base__,
  - __D√©tails du projet__ : 
    -  Cr√©er un nouveau groupe de ressources (nomm√© MichaudEtFils pour le projet)
  - __D√©tails du serveur__ : 
    - Donner un nom au serveur : entreprise-Michaud
    - R√©gion : choisir la r√©gion Canada East
  - Version de PostgreSQL du projet : _16_
  - Type de charge de travail : 
    - Choisir l'option d√©veloppement
  - __Authentification__ : 
    - Laisser l'option __Authentification PostgreSQL uniquement__.
  - Cr√©er un nouvel utilisateur administrateur : 
    - __utilisateur__ : MichaudEtFils 
    - __Mot de passe__ : !Deneigement-ete-hiver

4. Ongle Mise en r√©seau 
- S√©lectionner l'acc√®s public
  - Cocher __Autoriser l'acc√®s public √† partir d'un service Azure dans Azure sur ce serveur__.
  - Ajouter l'adresse IP actuelle qui es propos√©e pour cr√©er une r√®gle automatique dans le pare-feu
:::warning
L'adresse IP doit √™tre statique pour ne pas avoir √† reconfigurer l'adresse permise dans le pare-feu
:::
- Attendre le d√©ploiement qui est en cours √† cette √©tape.

5.Informations de connexion
- Aller dans l'onglet __Accueil__ pour acc√©der au portail de navigation du site.
- Cliquer sur entreprise-Michaud
  -  Vous serez √† pr√©sent dans la page __Informations__.

6. Se connecter au serveur de base de donn√©es:
- Avec Datagrip:
  -   Cr√©er une nouvelle connexion √† un serveur avec les informations dans l'encadr√©
- Avec les informations entr√©es, vous pouvez tester si la connexion 'a la base de donn√©es fonctionne.
- La base de donn√©es devrait √™tre cr√©√©e avec l'utilisateur __Owner__.

7. __APPS Service pour d√©ployer__.
- __L'onglet de base__
  -  __D√©tails de projet__:
      -  Abonnement: Azure for students
      -  Groupe de ressources: MichaudEtFils
  -  __D√©tails de l'instance__:
        -  __Nom__: michaud-et-fils-mvc
        -  __Publier__: Code
        -  __Pile d'ex√©cution__: .Net 7.0 (sts)
        -  __Syst√®me d'exploitation__: Windows
        -  __R√©gion__: US East

- __L'onglet d√©ploiement__
  - Param√®tre GitHub actions
  - D√©ploiement continu: __d√©sactiver__
  - V√©rifier les configurations et cliquer sur __Cr√©er__

- Aller sur __Rider__

 - D√©ploiement du projet MVC.
   -  Clic droit sur le projet -> Publish -> Azure
   - Installer le plugin Azure 
   - Red√©marrer l'application __Rider__
:::note
Il faut se connecter au compte Azure dans l'onglet Azure explorer pour continuer.
:::
- Nous avons maintenant acc√®s au plugin Azure qui permet de d√©ployer le projet MVC. ****

-  S√©lectionner __Use Existing Web App__

-  Choisir le projet __MVC__
-  Cliquez __Apply__ puis __Run__

- Une nouvelle configuration sera disponible dans les configurations en haut de l'√©cran.

-  Une page web s'affichera avec l'erreur 500.30 __C'est normal!__ Il manque les configurations de connexion √† la base de donn√©es.

8. D√©boguer les erreurs de d√©ploiement

:::note
La prochaine √©tape est de Diagnostiguer et r√©soudre les probl√®mes.
:::

- Il y aura des erreurs dans le journal d'√©v√©nement.

  -  Pour r√©gler l'erreur 1018 :
    -  Sur le site Azure, dans le dossier MVC -> Param√®tres -> Configurations -> Nouvelle chaine de connexion.
    -  Il faut cr√©er une nouvelle chaine de connexion
        -  Dans le app.settings.json dans le projet MVC, il y a les informations que nous avons besoin.
        -  Remplacer le __nom du serveur__, le nom de la Database du serveur Azure, le nom d'utilisateur et le mot de passe de la database sur Azure.
:::warning
N'oubliez pas d'__enregistrer__ votre chaine de connexion!
:::

9. Cr√©er un compte de stockge.
- Cliquez sur __Cr√©er un compte de stockage__.
- Assignez un __groupe de ressources__, un __nom__ et une __r√©gion__ √† votre compte de stockage
- Conservez toutes les autres options __par d√©faut__.

10. Cr√©er un partage de fichiers.
- S'assurez d'√™tre √† l'int√©rieur du compte de stockage.
- Allez √† la section __Partage de fichiers__.
- Cr√©ez un nouveau partage de fichier en appuyant sur __+ Partage de fichiers__. Garder les valeurs par d√©faut.

11. Monter le stockage
- Allez dans la section ```Configuration``` du projet MVC.
- S√©lectionnez l'onglet ```Mappages de chemin d'acc√®s```.
- Sous Monter le stockage, appuyez sur ```+ Nouveau montage de stockage Azure```
  -  Nom:  Un nom pour identifier le stockage
  -  Options de configuration: De base
  -  Comptes de stockage: s√©lectionnez votre compte cr√©√© pr√©c√©demment
  -  Conteneur de stockage: votre dossier de fichiers partag√©
  -  Chemin de montage: il s'agit du chemin d'acc√®s virtuel sur le serveur. Le nom n'a pas d'importance, tant que vous en prenez note et r√©utilisez le bon.
  -  Appuyer Ok, sauvegarder

12. Cr√©er le r√©pertoire virtuel
- Sous ```Applications et r√©pertoires virtuels```, appuyez sur ```+ Nouvelle application virtuelle ou nouveau r√©pertoire virtuel```
- Entrez les param√®tres
  -  Entre le chemin d'acc√®s virtuel ```/storage```
  -  Entrez le lien vers le stockage mont√© pr√©c√©demment ```\mounts\storage```
  -  Cochez ```Annuaire```
  -  Appuyer ```OK```

13. Modifier l'application

14. √âcriture de fichiers.

15. Installation du AZure powershell. SI l'extionsion UUID n'est pas disponible dans la liste d'extensions.
- T√©l√©charger Azure CLI
- Se connecter avec AzAccount
- Commande √† entrer 
  -   ```az postgres flexible-server parameter set --resource-group MichaudEtfils --server-name entreprise-michaud --subscription 4a84da0d-b1c3-4e60-b263-a2f31b9e7fb2 --name azure.extensions --value uuid-ossp```

<details>
<summary>Well</summary>

<details>
<summary>Try this</summary>

 <details>
 <summary>The other one</summary>

   <details> 
   <summary>Ok, try this</summary>

   You got me üòÇ
   </details>
 </details>
</details>
</details>








## Mise √† jour du serveur

## Conclusion

Voici ce qui conclut la proc√©dure de d√©ploiement. Vous pouvez maintenant acc√©der au site d√©ploy√© √† l'adresse x.
